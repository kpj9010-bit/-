<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ì¶˜ì²œ ì¥ë¡€ì‹ì¥ ë¹ˆì†Œí˜„í™©</title>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link href="https://fonts.googleapis.com/css2?family=Noto+Serif+KR:wght@600;700&family=Noto+Sans+KR:wght@300;400;500;600&display=swap" rel="stylesheet">
<style>
/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   ê¸°ë³¸ ì„¤ì •
   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
:root {
  --bg:            #eae7e1;
  --card:          #ffffff;
  --t1:            #1e1e1e;        /* ì£¼ í…ìŠ¤íŠ¸ */
  --t2:            #52524e;        /* ë³´ì¡° í…ìŠ¤íŠ¸ */
  --t3:            #8c8480;        /* ë¯¸íŒ… í…ìŠ¤íŠ¸ */
  --accent:        #4a6e5c;        /* ì´ˆë¡ ê³„ì—´ */
  --accent-light:  #eaf2ee;
  --border:        #e2ddd7;
  --border-soft:   #eceae6;
  --occ-bg:        #e6efe9;        /* ì‚¬ìš©ì¤‘ ë°°ê²½ */
  --occ-text:      #2d6b4a;        /* ì‚¬ìš©ì¤‘ í…ìŠ¤íŠ¸ */
  --empty-bg:      #f5f3f0;        /* ë¹ˆì†Œ ë°°ê²½ */
  --empty-text:    #a09890;        /* ë¹ˆì†Œ í…ìŠ¤íŠ¸ */
  --warn-bg:       #fdf4e8;
  --warn-text:     #c07a2e;
}

* { margin: 0; padding: 0; box-sizing: border-box; }

body {
  font-family: 'Noto Sans KR', sans-serif;
  background: var(--bg);
  color: var(--t1);
  min-height: 100vh;
  -webkit-font-smoothing: antialiased;
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   ê³ ì • í—¤ë”
   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.header {
  position: sticky;
  top: 0;
  z-index: 50;
  background: var(--card);
  border-bottom: 1px solid var(--border);
  box-shadow: 0 1px 8px rgba(0,0,0,0.04);
  padding: 18px 16px 14px;
  text-align: center;
}
.header h1 {
  font-family: 'Noto Serif KR', serif;
  font-size: 1.18rem;
  font-weight: 700;
  letter-spacing: -0.3px;
  margin-bottom: 2px;
}
.header .sub {
  font-size: 0.7rem;
  color: var(--t3);
  font-weight: 300;
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   íƒ­ ë„¤ë¹„
   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.tabs {
  display: flex;
  gap: 6px;
  padding: 12px 12px 0;
  max-width: 680px;
  margin: 0 auto;
  overflow-x: auto;
  scrollbar-width: none;
  -webkit-overflow-scrolling: touch;
}
.tabs::-webkit-scrollbar { display: none; }

.tab {
  flex-shrink: 0;
  display: inline-flex;
  align-items: center;
  gap: 5px;
  background: var(--card);
  border: 1px solid var(--border);
  border-radius: 20px;
  padding: 6px 13px;
  font-size: 0.74rem;
  font-weight: 500;
  color: var(--t2);
  cursor: pointer;
  white-space: nowrap;
  transition: all 0.18s ease;
  user-select: none;
}
.tab:hover { border-color: #b5ccc0; }
.tab.active {
  background: var(--accent);
  border-color: var(--accent);
  color: #fff;
}
.tab .cnt {
  font-size: 0.62rem;
  font-weight: 600;
  padding: 1px 5px;
  border-radius: 8px;
  background: var(--accent-light);
  color: var(--accent);
}
.tab.active .cnt {
  background: rgba(255,255,255,0.2);
  color: #fff;
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   ì¥ë¡€ì‹ì¥ ì¹´ë“œ ì»¨í…Œì´ë„ˆ
   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.cards {
  max-width: 680px;
  margin: 12px auto 60px;
  padding: 0 12px;
}

.card {
  display: none;
  background: var(--card);
  border-radius: 14px;
  box-shadow: 0 2px 16px rgba(0,0,0,0.05);
  overflow: hidden;
  animation: pop .2s ease;
}
.card.show { display: block; }

@keyframes pop {
  from { opacity: 0; transform: translateY(4px); }
  to   { opacity: 1; transform: translateY(0);   }
}

/* ì¹´ë“œ ìƒë‹¨ â€” ì´ë¦„ + ì „í™” */
.card-top {
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: 14px 16px 10px;
  border-bottom: 1px solid var(--border);
}
.card-top h2 {
  font-family: 'Noto Serif KR', serif;
  font-size: 0.96rem;
  font-weight: 600;
}
.card-top .tel a {
  font-size: 0.72rem;
  color: var(--accent);
  text-decoration: none;
  font-weight: 500;
}
.card-top .tel a:hover { text-decoration: underline; }

/* ì†Œê³„ ë°” */
.stat-bar {
  display: flex;
  align-items: center;
  gap: 14px;
  padding: 7px 16px;
  background: #f7f5f2;
  border-bottom: 1px solid var(--border);
  font-size: 0.68rem;
  color: var(--t3);
}
.stat-bar .s { display: flex; align-items: center; gap: 3px; }
.stat-bar .s strong { font-weight: 600; }
.stat-bar .s.occ strong { color: var(--occ-text); }
.stat-bar .s.emp strong { color: var(--empty-text); }
.stat-bar .orig {
  margin-left: auto;
  display: inline-flex;
  align-items: center;
  gap: 3px;
  font-size: 0.65rem;
  color: var(--t3);
  text-decoration: none;
  transition: color .18s;
}
.stat-bar .orig:hover { color: var(--accent); }
.stat-bar .orig svg { width: 10px; height: 10px; }

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   ë¹ˆì†Œ í–‰ ë¦¬ìŠ¤íŠ¸
   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.binso-list { padding: 6px 0; }

.binso-row {
  display: flex;
  min-height: 58px;
  border-bottom: 1px solid #f0ece6;
  transition: background .12s;
}
.binso-row:last-child { border-bottom: none; }
.binso-row:hover { background: #fdfdfc; }

/* ì™¼ìª½ â€” ë¹ˆì†Œ ë²ˆí˜¸ ë¸”ë¡ */
.b-num {
  width: 48px;
  flex-shrink: 0;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  gap: 0;
  border-right: 1px solid #f0ece6;
}
/* ì‚¬ìš©ì¤‘ ìƒíƒœ */
.binso-row.occ .b-num { background: var(--occ-bg); }
.binso-row.occ .b-num .b-label { color: var(--occ-text); }
.binso-row.occ .b-num .b-val   { color: var(--occ-text); }
/* ë¹ˆì†Œ ìƒíƒœ */
.binso-row.emp .b-num { background: var(--empty-bg); }
.binso-row.emp .b-num .b-label { color: var(--empty-text); }
.binso-row.emp .b-num .b-val   { color: #c8c2bb; }

.b-num .b-label {
  font-size: 0.55rem;
  font-weight: 600;
  letter-spacing: 0.3px;
  text-transform: uppercase;
}
.b-num .b-val {
  font-size: 0.82rem;
  font-weight: 600;
  margin-top: 1px;
}

/* ì˜¤ë¥¸ìª½ â€” ì •ë³´ ì˜ì—­ */
.b-info {
  flex: 1;
  padding: 9px 14px;
  display: flex;
  flex-direction: column;
  justify-content: center;
  gap: 4px;
}

/* ê³ ì¸ëª… í–‰ */
.b-top {
  display: flex;
  align-items: center;
  justify-content: space-between;
}
.b-name {
  font-size: 0.88rem;
  font-weight: 600;
}
.binso-row.occ .b-name { color: var(--t1); }
.binso-row.emp .b-name { color: #bbb5ae; font-weight: 400; font-style: italic; }

/* ìƒíƒœ ë°°ì§€ */
.badge {
  font-size: 0.6rem;
  font-weight: 600;
  padding: 2px 7px;
  border-radius: 8px;
  letter-spacing: 0.2px;
}
.badge.occ { background: var(--occ-bg); color: var(--occ-text); }
.badge.emp { background: var(--empty-bg); color: var(--empty-text); }

/* ì„¸ë¶€ ì •ë³´ í–‰ */
.b-detail {
  display: flex;
  gap: 10px;
  flex-wrap: wrap;
}
.b-detail .d {
  font-size: 0.68rem;
  color: var(--t3);
  display: flex;
  align-items: center;
  gap: 3px;
}
.b-detail .d .dv {
  color: var(--t2);
  font-weight: 500;
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   ì—…ë°ì´íŠ¸ ì¤‘ & ë¡œë”© ìƒíƒœ
   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.notice {
  padding: 38px 20px;
  text-align: center;
}
.notice .ico {
  width: 44px; height: 44px;
  border-radius: 50%;
  display: flex; align-items: center; justify-content: center;
  margin: 0 auto 12px;
}
.notice .ico svg { width: 20px; height: 20px; }
.notice .ico.warn { background: var(--warn-bg); }
.notice .ico.warn svg { color: var(--warn-text); }
.notice .ico.load { background: #f0f4ff; }
.notice .ico.load svg { color: #5577cc; }
.notice h3 { font-size: 0.86rem; font-weight: 600; margin-bottom: 4px; }
.notice p { font-size: 0.72rem; color: var(--t3); line-height: 1.6; }

/* ìŠ¤í•€ animaton */
@keyframes spin { to { transform: rotate(360deg); } }
.spin { animation: spin 1s linear infinite; }

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   ë°˜ì‘í˜•
   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
@media (max-width: 440px) {
  .b-num { width: 42px; }
  .b-num .b-val { font-size: 0.76rem; }
  .b-info { padding: 8px 10px; }
  .card-top { flex-direction: column; align-items: flex-start; gap: 4px; }
}
</style>
</head>
<body>

<div class="header">
  <h1>ì¶˜ì²œ ì¥ë¡€ì‹ì¥ ë¹ˆì†Œí˜„í™©</h1>
  <span class="sub" id="lastUpdate">ë¡œë”© ì¤‘â€¦</span>
</div>

<div class="tabs" id="tabs"></div>
<div class="cards" id="cards"></div>

<script>
/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   ì¥ë¡€ì‹ì¥ ì •ë³´ ì •ì˜
   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
const PARLORS = [
  {
    id: 'chuncheon',
    name: 'ì¶˜ì²œì¥ë¡€ì‹ì¥',
    tel: '033-256-4444',
    telHref: 'tel:03325644444',
    origUrl: 'https://e-iris.co.kr/display/parlor/iframe/324',
    source: 'static', // ìˆ˜ë™ ìœ ì§€
    allNums: ['101í˜¸','102í˜¸','201í˜¸','202í˜¸','301í˜¸'],
    binsos: [
      { num: '101í˜¸', name: 'ê¹€â—‹â—‹',  occ: true,  place: 'ì¶˜ì²œì•ˆì‹ì› ë™ì‚°ì¶”ëª¨ê³µì›', checkin: '02.01 10:00', checkout: '02.02 07:00' },
      { num: '102í˜¸', occ: false },
      { num: '201í˜¸', name: 'ì´â—‹â—‹',  occ: true,  place: 'ì¶˜ì²œì•ˆì‹ì› ì„œìš¸í˜„ì¶©ì›',   checkin: '02.01 14:00', checkout: '02.03 06:30' },
      { num: '202í˜¸', occ: false },
      { num: '301í˜¸', occ: false },
    ]
  },
  {
    id: 'hyojanglye',
    name: 'ê°•ì›íš¨ì¥ë¡€ë¬¸í™”ì›',
    tel: '033-261-4441',
    telHref: 'tel:03326144441',
    origUrl: 'https://e-baro.co.kr/api_view/?code=icBnKH',
    source: 'proxy', // ê³µê°œ í”„ë¡ì‹œë¡œ ì‹¤ì‹œê°„ fetch ê°€ëŠ¥
    fetchUrl: 'https://e-baro.co.kr/api_view/?code=icBnKH',
    allNums: ['101í˜¸','201í˜¸','202í˜¸','301í˜¸','302í˜¸'],
    binsos: []
  },
  {
    id: 'hoban',
    name: 'í˜¸ë°˜ë³‘ì›ì¥ë¡€ì‹ì¥',
    tel: '033-252-0046',
    telHref: 'tel:03325200046',
    origUrl: 'http://www.hobanfuneral.co.kr/index.php?mid=sub43&sort_index=var1&order_type=asc',
    source: 'static',
    allNums: ['1í˜¸(íŠ¹ì‹¤)','2í˜¸','3í˜¸','5í˜¸','6í˜¸','7í˜¸','8í˜¸'],
    binsos: [
      { num: '1í˜¸(íŠ¹ì‹¤)', name: 'ìš´ê²½ì• ', occ: true,  place: 'ì¶˜ì²œì•ˆì‹ê³µì›', checkin: '02.02 09:00', checkout: '02.03 06:30' },
      { num: '2í˜¸', occ: false },
      { num: '3í˜¸', occ: false },
      { num: '5í˜¸', occ: false },
      { num: '6í˜¸', name: 'ì¡°ì„±ì¬', occ: true,  place: 'ì¶˜ì²œì•ˆì‹ê³µì›', checkin: '02.01 11:00', checkout: '02.02 06:30' },
      { num: '7í˜¸', occ: false },
      { num: '8í˜¸', occ: false },
    ]
  },
  {
    id: 'gangwon-univ',
    name: 'ê°•ì›ëŒ€í•™êµë³‘ì›ì¥ë¡€ì‹ì¥',
    tel: '033-254-5611',
    telHref: 'tel:03325445611',
    origUrl: 'https://m.knuh.or.kr/hospitalinfor/funeral_01.asp',
    source: 'static',
    allNums: ['1í˜¸','2í˜¸','3í˜¸','5í˜¸','6í˜¸','7í˜¸'],
    binsos: [
      { num: '1í˜¸', occ: false },
      { num: '2í˜¸', occ: false },
      { num: '3í˜¸', occ: false },
      { num: '5í˜¸', name: 'ì´ë³µë¡€', occ: true,  place: 'ì¶˜ì²œ ì•ˆì‹ì›', checkin: '02.01 09:30', checkout: '02.02 06:00' },
      { num: '6í˜¸', name: 'ê¹€ì˜ë¯¸', occ: true,  place: 'ì¶˜ì²œ ì•ˆì‹ì›', checkin: '02.02 09:30', checkout: '02.03 08:00' },
      { num: '7í˜¸', occ: false },
    ]
  },
  {
    id: 'citizen',
    name: 'ì¶˜ì²œ ì‹œë¯¼ì¥ë¡€ì‹ì¥',
    tel: null,
    updating: true,
    source: 'static',
    binsos: []
  }
];

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   ë‚ ì§œ í¬ë§· ìœ í‹¸
   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
function fmtDate(s) {
  if (!s) return '';
  s = s.trim();
  let m = s.match(/(\d{4})-(\d{2})-(\d{2})\s+([\d:]+)/);
  if (m) return `${m[2]}.${m[3]} ${m[4]}`;
  m = s.match(/(\d{1,2})ì›”\s*(\d{1,2})ì¼[.\s]*(\d{1,2})ì‹œ\s*(\d{1,2})ë¶„/);
  if (m) return `${m[1].padStart(2,'0')}.${m[2].padStart(2,'0')} ${m[3].padStart(2,'0')}:${m[4].padStart(2,'0')}`;
  return s;
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   â‘  íš¨ì¥ë¡€ë¬¸í™”ì› íŒŒì‹± (í”„ë¡ì‹œ ì‹¤ì‹œê°„ fetchìš©)
   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
function parseHyo(html) {
  const doc = new DOMParser().parseFromString(html, 'text/html');
  const rows = doc.querySelectorAll('table tr');
  const result = [];
  rows.forEach(row => {
    const tds = row.querySelectorAll('td');
    if (tds.length >= 7) {
      const num  = tds[1]?.textContent?.trim();
      const name = tds[2]?.textContent?.trim();
      const place= tds[4]?.textContent?.trim();
      const ci   = tds[5]?.textContent?.trim();
      const co   = tds[6]?.textContent?.trim();
      if (num && name && !num.includes('ë²ˆí˜¸')) {
        result.push({ num, name, occ: true, place, checkin: fmtDate(ci), checkout: fmtDate(co) });
      }
    }
  });
  return result;
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   ê³µê°œ CORS í”„ë¡ì‹œë¡œ íš¨ì¥ë¡€ fetch
   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
const CORS_PROXIES = [
  url => `https://corsproxy.io/?${encodeURIComponent(url)}`,
  url => `https://api.codetabs.com/v1/proxy?quest=${encodeURIComponent(url)}`,
  url => `https://corsproxy.org/?${encodeURIComponent(url)}`,
];

async function fetchViaProxy(url) {
  for (const buildUrl of CORS_PROXIES) {
    try {
      const res = await fetch(buildUrl(url), { signal: AbortSignal.timeout(8000) });
      if (res.ok) {
        const html = await res.text();
        if (html.length > 100) return html;
      }
    } catch (e) { continue; }
  }
  return null;
}

async function fetchHyo(p) {
  const html = await fetchViaProxy(p.fetchUrl);
  if (!html) { console.warn(`[${p.name}] í”„ë¡ì‹œ ì‹¤íŒ¨`); return false; }

  const occupied = parseHyo(html);
  const occMap = {};
  occupied.forEach(o => { occMap[o.num] = o; });
  p.binsos = p.allNums.map(n => occMap[n] || { num: n, occ: false });

  console.log(`[${p.name}] âœ… í”„ë¡ì‹œ ì—…ë°ì´íŠ¸ ì™„ë£Œ â€” ì‚¬ìš©ì¤‘ ${occupied.length}ê°œ`);
  return true;
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   ì „ì²´ ì—…ë°ì´íŠ¸
   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
async function updateAll() {
  // íš¨ì¥ë¡€ â€” í”„ë¡ì‹œ ì‹¤ì‹œê°„
  for (let i = 0; i < PARLORS.length; i++) {
    const p = PARLORS[i];
    if (p.source !== 'proxy') continue;
    const ok = await fetchHyo(p);
    if (ok) rerenderCard(i);
  }
  document.getElementById('lastUpdate').textContent =
    'ë§ˆì§€ë§‰ ì—…ë°ì´íŠ¸: ' + new Date().toLocaleTimeString('ko-KR', { hour:'2-digit', minute:'2-digit' });
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   ì¹´ë“œ ì¬ë Œë”ë§
   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
function rerenderCard(idx) {
  const p    = PARLORS[idx];
  const card = document.getElementById('card-' + idx);
  const tab  = document.querySelectorAll('.tab')[idx];
  if (!card || !tab) return;

  card.innerHTML = buildCard(p);

  const occ   = (p.binsos || []).filter(b => b.occ).length;
  const total = (p.binsos || []).length;
  tab.innerHTML = p.name + ' <span class="cnt">' + (p.updating ? 'â€“' : occ + '/' + total) + '</span>';
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   ì´ˆê¸° ë Œë”ë§
   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
function renderAll() {
  const tabsEl  = document.getElementById('tabs');
  const cardsEl = document.getElementById('cards');

  PARLORS.forEach((p, i) => {
    const occ   = (p.binsos || []).filter(b => b.occ).length;
    const total = (p.binsos || []).length;

    const tab = document.createElement('button');
    tab.className = 'tab' + (i === 0 ? ' active' : '');
    tab.dataset.idx = i;
    tab.onclick = () => switchTab(i);
    tab.innerHTML = p.name + ' <span class="cnt">' + (p.updating ? 'â€“' : occ + '/' + total) + '</span>';
    tabsEl.appendChild(tab);

    const card = document.createElement('div');
    card.className = 'card' + (i === 0 ? ' show' : '');
    card.id = 'card-' + i;
    card.innerHTML = buildCard(p);
    cardsEl.appendChild(card);
  });
}

function buildCard(p) {
  if (p.updating) {
    return `
      <div class="card-top"><h2>${p.name}</h2></div>
      <div class="notice">
        <div class="ico warn">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8">
            <circle cx="12" cy="12" r="9"/>
            <path d="M12 6v6l4 2" stroke-linecap="round" stroke-linejoin="round"/>
          </svg>
        </div>
        <h3>ë¹ˆì†Œí˜„í™© ì—…ë°ì´íŠ¸ ì¤‘</h3>
        <p>í˜„ì¬ ì •ë³´ê°€ ì—…ë°ì´íŠ¸ ì§„í–‰ ì¤‘ì…ë‹ˆë‹¤.<br>ì ì‹œ í›„ ë‹¤ì‹œ í™•ì¸í•´ ì£¼ì„¸ìš”.</p>
      </div>`;
  }

  const binsos = p.binsos || [];
  const occ   = binsos.filter(b => b.occ).length;
  const emp   = binsos.length - occ;

  let rows = '';
  binsos.forEach(b => {
    if (b.occ) {
      rows += `
        <div class="binso-row occ">
          <div class="b-num">
            <span class="b-label">ë¹ˆì†Œ</span>
            <span class="b-val">${b.num}</span>
          </div>
          <div class="b-info">
            <div class="b-top">
              <span class="b-name">${b.name}</span>
              <span class="badge occ">ì‚¬ìš©ì¤‘</span>
            </div>
            <div class="b-detail">
              ${b.place && b.place !== '-' ? `<span class="d">ì¥ì§€ <span class="dv">${b.place}</span></span>` : ''}
              ${b.checkin && b.checkin !== '-' ? `<span class="d">ì…ê´€ <span class="dv">${b.checkin}</span></span>` : ''}
              ${b.checkout && b.checkout !== '-' ? `<span class="d">ë°œì¸ <span class="dv">${b.checkout}</span></span>` : ''}
            </div>
          </div>
        </div>`;
    } else {
      rows += `
        <div class="binso-row emp">
          <div class="b-num">
            <span class="b-label">ë¹ˆì†Œ</span>
            <span class="b-val">${b.num}</span>
          </div>
          <div class="b-info">
            <div class="b-top">
              <span class="b-name">ë¹ˆì†Œ ë¯¸ì‚¬ìš©</span>
              <span class="badge emp">ë¹ˆì†Œ</span>
            </div>
          </div>
        </div>`;
    }
  });

  if (binsos.length === 0) {
    rows = `
      <div class="notice">
        <div class="ico load">
          <svg class="spin" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.2">
            <path d="M12 2v4M12 18v4M4.93 4.93l2.83 2.83M16.24 16.24l2.83 2.83M2 12h4M18 12h4M4.93 19.07l2.83-2.83M16.24 7.76l2.83-2.83" stroke-linecap="round"/>
          </svg>
        </div>
        <h3>ë°ì´í„° ë¡œë”© ì¤‘â€¦</h3>
        <p>ì ì‹œ ê¸°ë‹¤ë ¤ ì£¼ì„¸ìš”.</p>
      </div>`;
  }

  return `
    <div class="card-top">
      <h2>${p.name}</h2>
      ${p.tel ? `<span class="tel">ğŸ“ <a href="${p.telHref}">${p.tel}</a></span>` : ''}
    </div>
    <div class="stat-bar">
      <span class="s">ì „ì²´ <strong>${binsos.length}ê°œ</strong></span>
      <span class="s occ">ì‚¬ìš©ì¤‘ <strong>${occ}ê°œ</strong></span>
      <span class="s emp">ë¹ˆì†Œ <strong>${emp}ê°œ</strong></span>
      ${p.origUrl ? `<a href="${p.origUrl}" target="_blank" class="orig">
        ì›ë³¸ í˜ì´ì§€
        <svg viewBox="0 0 12 12" fill="none"><path d="M8 2h2v2M5.5 6.5l5-5M9 6.5v3.2C9 10.2 8.2 11 7.2 11H2.8C1.8 11 1 10.2 1 9.2V4.8C1 3.8 1.8 3 2.8 3H5.5" stroke="currentColor" stroke-width="1.1" stroke-linecap="round" stroke-linejoin="round"/></svg>
      </a>` : ''}
    </div>
    <div class="binso-list">${rows}</div>`;
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   íƒ­ ì „í™˜
   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
function switchTab(idx) {
  document.querySelectorAll('.tab').forEach((t, i) => t.classList.toggle('active', i === idx));
  document.querySelectorAll('.card').forEach((c, i) => c.classList.toggle('show', i === idx));
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   ì´ˆê¸°í™”
   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
renderAll();
updateAll();
setInterval(updateAll, 600000); // 10ë¶„ ê°„ê²©
</script>
</body>
</html>
